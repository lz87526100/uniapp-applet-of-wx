{"version":3,"file":"detail.js","sources":["pages/blog/detail.vue","E:/movie/HBuilderX.4.57.2025032507/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYmxvZy9kZXRhaWwudnVl"],"sourcesContent":["<template>\n  <view class=\"detailLayout\">\n    <!-- 头部标签 -->\n    <view class=\"soupDetail\">\n      <!-- <self-tab-group /> -->\n      <!-- 文章内容 -->\n      <view class=\"content\" v-if=\"article\">\n        <!-- 商家评价信息 - 新版设计 -->\n        <view v-if=\"shopInfo\" class=\"shop-review-section\">\n          <!-- 商家卡片 -->\n          <view class=\"shop-card\">\n            <!-- 商家头部 -->\n            <view class=\"shop-header\">\n              <view class=\"shop-avatar-container\">\n                <image \n                  class=\"shop-avatar\" \n                  :src=\"getShopAvatar(shopInfo)\"\n                  mode=\"aspectFill\"\n                  @error=\"handleShopAvatarError\"\n                />\n                <view class=\"shop-badge\" v-if=\"shopInfo.isVerified\">\n                  <text class=\"badge-icon\">✓</text>\n                </view>\n              </view>\n              \n              <view class=\"shop-main-info\">\n                <view class=\"shop-title-row\">\n                  <text class=\"shop-name\">{{ shopInfo.shopName || '未知商家' }}</text>\n                  <view class=\"rating-display\" v-if=\"shopInfo.rating > 0\">\n                    <text class=\"rating-star\">★</text>\n                    <text class=\"rating-value\">{{ (shopInfo.rating / 10).toFixed(1) }}</text>\n                  </view>\n                </view>\n                \n                <view class=\"shop-tags\">\n                  <view class=\"status-tag\" :class=\"{ open: isShopOpen }\">\n                    <text class=\"status-dot\" :class=\"{ open: isShopOpen }\"></text>\n                    <text class=\"status-text\">{{ isShopOpen ? '营业中' : '已打烊' }}</text>\n                  </view>\n                  <text class=\"category-tag\">{{ shopInfo.category || '美食' }}</text>\n                </view>\n              </view>\n            </view>\n\n            <!-- 商家数据 -->\n            <view class=\"shop-stats\">\n              <view class=\"stat-item\">\n                <text class=\"stat-value\">{{ formatNumber(shopInfo.monthlyOrders || 0) }}</text>\n                <text class=\"stat-label\">月售</text>\n              </view>\n              <view class=\"stat-divider\"></view>\n              <view class=\"stat-item\">\n                <text class=\"stat-value\">{{ shopInfo.deliveryTime || '30-40' }}</text>\n                <text class=\"stat-label\">分钟</text>\n              </view>\n              <view class=\"stat-divider\"></view>\n              <view class=\"stat-item\">\n                <text class=\"stat-value\">{{ (shopInfo.deliveryFee || 0) === 0 ? '免费' : `¥${shopInfo.deliveryFee}` }}</text>\n                <text class=\"stat-label\">配送</text>\n              </view>\n            </view>\n\n            <!-- 商家信息 -->\n            <view class=\"shop-details\">\n              <view class=\"detail-item\" v-if=\"shopInfo.address\">\n                <uni-icons type=\"location-filled\" size=\"16\" color=\"#666\" />\n                <text class=\"detail-text\">{{ shopInfo.address }}</text>\n              </view>\n              <view class=\"detail-item\" v-if=\"shopInfo.businessHours\">\n                <uni-icons type=\"time-filled\" size=\"16\" color=\"#666\" />\n                <text class=\"detail-text\">{{ shopInfo.businessHours }}</text>\n              </view>\n              <view class=\"detail-item\" v-if=\"shopInfo.phone\">\n                <uni-icons type=\"phone-filled\" size=\"16\" color=\"#666\" />\n                <text class=\"detail-text\">{{ shopInfo.phone }}</text>\n                <text class=\"contact-btn\" @click=\"handlePhoneCall\">拨打</text>\n              </view>\n            </view>\n\n            <!-- 操作按钮 -->\n            <view class=\"shop-actions\">\n              <view class=\"action-btn primary\" @click=\"navigateToShop\">\n                <uni-icons type=\"shop\" size=\"18\" color=\"#fff\" />\n                <text class=\"btn-text\">进入店铺</text>\n              </view>\n              <view class=\"action-btn secondary\" @click=\"showContact\">\n                <uni-icons type=\"chat\" size=\"18\" color=\"#FF6B35\" />\n                <text class=\"btn-text\">评论</text>\n              </view>\n            </view>\n          </view>\n        </view>\n\n        <!-- 用户信息区域 -->\n        <view class=\"userinfo\">\n          <view class=\"user-avatar-container\">\n            <image\n              class=\"avatar\"\n              :src=\"getUserAvatar(article.user_id[0])\"\n              mode=\"aspectFill\"\n              @error=\"handleAvatarError\"\n            />\n          </view>\n          <view class=\"user-info-main\">\n            <text class=\"username\">{{ article.user_id[0]?.nickname || '匿名' }}</text>\n            <text class=\"time\">\n              <uni-dateformat\n                :date=\"article.publish_date\"\n                format=\"MM-dd hh:mm\"\n                :threshold=\"[60000, 3600000*24*30]\"\n              />\n            </text>\n          </view>\n        </view>\n\n        <!-- 评论内容 -->\n        <view class=\"comment-content\">\n          <text class=\"comment-text\">{{ article.content }}</text>\n        </view>\n\n        <!-- 图片 -->\n        <view v-if=\"article.pics?.length\" class=\"pics\">\n          <image\n            v-for=\"(pic, idx) in article.pics\"\n            :key=\"idx\"\n            class=\"pic\"\n            :src=\"pic.url\"\n            mode=\"aspectFill\"\n            @click.stop=\"preview(article.pics, idx)\"\n          />\n        </view>\n\n        <!-- 操作工具栏 -->\n        <view class=\"action-toolbar\">\n          <view class=\"toolbar-item\" @click=\"toggleFavorite\">\n            <view class=\"icon-wrapper\" :class=\"{ favorited: isFavorited }\">\n              <uni-icons \n                :type=\"isFavorited ? 'heart-filled' : 'heart'\" \n                :color=\"isFavorited ? '#fff' : '#8B9AB6'\" \n                size=\"20\" \n              />\n            </view>\n            <text class=\"btn-text\">{{ isFavorited ? '已收藏' : '收藏' }}</text>\n          </view>\n          \n          <view class=\"toolbar-item\" @click=\"shareArticle\">\n            <view class=\"icon-wrapper\">\n              <uni-icons type=\"redo\" size=\"20\" color=\"#8B9AB6\" />\n            </view>\n            <text class=\"btn-text\">分享</text>\n          </view>\n\n          <view \n            v-if=\"isPermission(article.user_id[0]?._id)\"\n            class=\"toolbar-item\" \n            @click=\"removeArticle\"\n          >\n            <view class=\"icon-wrapper delete\">\n              <uni-icons type=\"trash\" size=\"20\" color=\"#FF5B5B\" />\n            </view>\n            <text class=\"btn-text\">删除</text>\n          </view>\n        </view>\n      </view>\n      \n      <!-- 加载状态 -->\n      <view v-else class=\"loading\">\n        <uni-load-more status=\"loading\" content=\"加载中...\"></uni-load-more>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted, onUnmounted, computed } from 'vue'\nimport { onLoad, onShow } from '@dcloudio/uni-app'\nimport { isPermission } from '@/utils/common.js'\nimport favoritesManager from '@/common/style/favorites.js'\n\n/* ---------- 数据 ---------- */\nconst article = ref(null)\nconst loading = ref(false)\nconst shopInfo = ref(null)\nconst shopId = ref('')\nconst isFavorited = ref(false)\nconst userAvatarCache = ref(new Map())\n\n// 计算店铺是否营业\nconst isShopOpen = computed(() => {\n  if (!shopInfo.value?.businessHours) return true;\n  \n  const hoursStr = shopInfo.value.businessHours;\n  const [start, end] = hoursStr.split('-');\n  if (!start || !end) return true;\n  \n  const now = new Date();\n  const currentHours = now.getHours();\n  const currentMinutes = now.getMinutes();\n  const currentTime = currentHours * 60 + currentMinutes;\n  \n  const [startHours, startMinutes] = start.split(':').map(Number);\n  const [endHours, endMinutes] = end.split(':').map(Number);\n  \n  const startTime = startHours * 60 + (startMinutes || 0);\n  const endTime = endHours * 60 + (endMinutes || 0);\n  \n  return currentTime >= startTime && currentTime <= endTime;\n});\n\n/* ---------- 生命周期 ---------- */\nonLoad((options) => {\n  if (options.id) {\n    if (options.shopId) {\n      shopId.value = options.shopId\n      getShopDetail(shopId.value)\n    }\n    getArticleDetail(options.id)\n  } else {\n    uni.showToast({ title: '缺少文章ID', icon: 'none' })\n    uni.navigateBack()\n  }\n})\n\n/* ---------- 云对象 ---------- */\nconst articlesCloudObj = uniCloud.importObject('articlesCloudObj')\n\n/* ---------- 商家相关函数 ---------- */\nasync function getShopDetail(shopId) {\n  if (!shopId) return\n  \n  try {\n    const res = await uniCloud.callFunction({\n      name: 'getShopDetail',\n      data: { shopId }\n    })\n\n    if (res.result?.errCode === 0) {\n      shopInfo.value = res.result.data\n      if (shopInfo.value.shopPic) {\n        await processShopImage(shopInfo.value)\n      }\n    }\n  } catch (error) {\n    console.error('加载商家信息异常:', error)\n  }\n}\n\nasync function processShopImage(shop) {\n  if (!shop.shopPic) return\n  try {\n    if (shop.shopPic.startsWith('cloud:')) {\n      const result = await uniCloud.getTempFileURL({\n        fileList: [shop.shopPic]\n      })\n      if (result.fileList && result.fileList[0]?.tempFileURL) {\n        shop.shopPic = result.fileList[0].tempFileURL\n      }\n    }\n  } catch (error) {\n    console.error('转换商家图片URL失败:', error)\n  }\n}\n\nconst getShopAvatar = (shop) => {\n  return shop?.shopPic || '/static/default-shop.jpg'\n}\n\nconst handleShopAvatarError = (event) => {\n  event.target.src = '/static/default-shop.jpg'\n}\n\nfunction formatNumber(num) {\n  if (num >= 10000) return (num / 10000).toFixed(1) + '万'\n  return num.toString()\n}\n\nfunction handlePhoneCall() {\n  if (!shopInfo.value?.phone) return\n  uni.makePhoneCall({\n    phoneNumber: shopInfo.value.phone,\n    fail: () => {\n      uni.showToast({ title: '无法拨打电话', icon: 'none' })\n    }\n  })\n}\n\nfunction navigateToShop() {\n  if (!shopInfo.value?._id) return\n  uni.navigateTo({\n    url: `/pages/shopList/shopDetail?id=${shopInfo.value._id}`\n  })\n}\n\nfunction showContact() {\n  if (!shopInfo.value) return\n  uni.navigateTo({\n    url: `/pages/blog/edit?shopId=${shopInfo.value._id}`\n  })\n}\n\n/* ---------- 用户头像相关函数 ---------- */\nconst setupUserInfoListeners = () => {\n  uni.$on('userInfoUpdated', updateUserAvatarInDetail)\n}\n\nconst updateUserAvatarInDetail = (userData) => {\n  if (!userData.userId || !userData.avatar || !article.value) return\n  userAvatarCache.value.set(userData.userId, userData.avatar)\n  \n  if (article.value.user_id && article.value.user_id[0]?._id === userData.userId) {\n    if (!article.value.user_id[0].avatar_file) {\n      article.value.user_id[0].avatar_file = {}\n    }\n    article.value.user_id[0].avatar_file.url = userData.avatar\n    article.value.user_id[0].avatar_url = userData.avatar\n    article.value = { ...article.value }\n  }\n}\n\nconst getUserAvatar = (user) => {\n  if (!user || !user._id) return '/static/defAvatar.png'\n  const userId = user._id\n  \n  if (userAvatarCache.value.has(userId)) {\n    return userAvatarCache.value.get(userId)\n  }\n  \n  let avatarUrl = '/static/defAvatar.png'\n  if (user.avatar_url && user.avatar_url.startsWith('http')) {\n    avatarUrl = user.avatar_url\n  } else if (user.avatar_file?.url) {\n    const fileUrl = user.avatar_file.url\n    if (fileUrl.startsWith('cloud:')) {\n      convertCloudFileUrl(fileUrl, userId)\n      return '/static/defAvatar.png'\n    } else if (fileUrl.startsWith('http')) {\n      avatarUrl = fileUrl\n    }\n  } else if (user.avatar?.startsWith('http')) {\n    avatarUrl = user.avatar\n  }\n  \n  if (avatarUrl !== '/static/defAvatar.png') {\n    userAvatarCache.value.set(userId, avatarUrl)\n  }\n  \n  return avatarUrl\n}\n\nconst convertCloudFileUrl = async (fileUrl, userId) => {\n  try {\n    const result = await uniCloud.getTempFileURL({ fileList: [fileUrl] })\n    if (result.fileList?.[0]?.tempFileURL) {\n      const httpUrl = result.fileList[0].tempFileURL\n      userAvatarCache.value.set(userId, httpUrl)\n      \n      if (article.value?.user_id?.[0]?._id === userId) {\n        if (!article.value.user_id[0].avatar_file) {\n          article.value.user_id[0].avatar_file = {}\n        }\n        article.value.user_id[0].avatar_file.url = httpUrl\n        article.value.user_id[0].avatar_url = httpUrl\n        article.value = { ...article.value }\n      }\n    }\n  } catch (error) {\n    console.error('转换云存储URL失败:', error)\n  }\n}\n\nconst handleAvatarError = (event) => {\n  event.target.src = '/static/defAvatar.png'\n}\n\nconst initUserAvatarCache = () => {\n  if (!article.value?.user_id?.[0]) return\n  const user = article.value.user_id[0]\n  const userId = user._id\n  \n  let avatarUrl = '/static/defAvatar.png'\n  if (user.avatar_url?.startsWith('http')) {\n    avatarUrl = user.avatar_url\n  } else if (user.avatar_file?.url) {\n    const fileUrl = user.avatar_file.url\n    if (fileUrl.startsWith('http')) {\n      avatarUrl = fileUrl\n    } else if (fileUrl.startsWith('cloud:')) {\n      convertCloudFileUrl(fileUrl, userId)\n    }\n  } else if (user.avatar?.startsWith('http')) {\n    avatarUrl = user.avatar\n  }\n  \n  if (avatarUrl !== '/static/defAvatar.png') {\n    userAvatarCache.value.set(userId, avatarUrl)\n  }\n}\n\n/* ---------- 文章操作功能 ---------- */\nasync function getArticleDetail(id) {\n  loading.value = true\n  try {\n    const { errCode, data, errMsg } = await articlesCloudObj.getDetail(id)\n    if (errCode === 0) {\n      article.value = data\n      initUserAvatarCache()\n      \n      if (!data.shop_id && shopId.value) {\n        await getShopDetail(shopId.value)\n      } else if (data.shop_id) {\n        await getShopDetail(data.shop_id)\n      }\n      \n      await checkFavoriteStatus()\n    } else {\n      uni.showToast({ title: errMsg || '获取文章失败', icon: 'none' })\n    }\n  } catch (error) {\n    console.error('获取文章详情失败:', error)\n    uni.showToast({ title: '网络错误', icon: 'none' })\n  } finally {\n    loading.value = false\n  }\n}\n\nasync function checkFavoriteStatus() {\n  try {\n    if (!article.value?._id) return\n    const userInfo = uni.getStorageSync('uni-id-pages-userInfo')\n    if (!userInfo?._id) {\n      isFavorited.value = false\n      return\n    }\n    const status = await favoritesManager.checkFavorite(article.value._id)\n    isFavorited.value = status\n  } catch (error) {\n    console.error('检查收藏状态失败:', error)\n    isFavorited.value = false\n  }\n}\n\nasync function toggleFavorite() {\n  try {\n    if (!article.value?._id) return\n    const userInfo = uni.getStorageSync('uni-id-pages-userInfo')\n    if (!userInfo?._id) {\n      uni.showToast({ title: '请先登录', icon: 'none' })\n      return\n    }\n    \n    if (isFavorited.value) {\n      const success = await favoritesManager.removeFavorite(article.value._id)\n      if (success) {\n        isFavorited.value = false\n        uni.showToast({ title: '取消收藏', icon: 'success' })\n      }\n    } else {\n      const success = await favoritesManager.addFavorite(article.value._id)\n      if (success) {\n        isFavorited.value = true\n        uni.showToast({ title: '收藏成功', icon: 'success' })\n      }\n    }\n  } catch (error) {\n    console.error('切换收藏状态失败:', error)\n    uni.showToast({ title: '操作失败，请重试', icon: 'none' })\n  }\n}\n\nfunction shareArticle() {\n  uni.share({\n    provider: \"weixin\",\n    type: 0,\n    title: article.value?.content?.substring(0, 20) + '...' || '分享内容',\n    summary: article.value?.content || '',\n    href: `/pages/blog/detail?id=${article.value?._id}`,\n    success: () => {\n      uni.showToast({ title: '分享成功', icon: 'success' })\n    },\n    fail: () => {\n      uni.showToast({ title: '分享失败', icon: 'none' })\n    }\n  })\n}\n\nasync function removeArticle() {\n  if (!article.value?._id) return\n  const { confirm } = await uni.showModal({\n    title: '提示',\n    content: '确认删除这条内容？',\n    confirmColor: '#FF5B5B'\n  })\n  if (!confirm) return\n  \n  try {\n    const { errCode } = await articlesCloudObj.remove(article.value._id)\n    if (errCode === 0) {\n      uni.showToast({ title: '删除成功', icon: 'success' })\n      setTimeout(() => uni.navigateBack(), 1500)\n    } else {\n      uni.showToast({ title: '删除失败', icon: 'none' })\n    }\n  } catch (error) {\n    console.error('删除文章失败:', error)\n    uni.showToast({ title: '删除失败', icon: 'none' })\n  }\n}\n\nfunction preview(pics, idx) {\n  uni.previewImage({\n    urls: pics.map(p => p.url),\n    current: idx\n  })\n}\n\n/* ---------- 页面生命周期 ---------- */\nonMounted(() => {\n  setupUserInfoListeners()\n  const pendingUpdate = uni.getStorageSync('userInfoPendingUpdate')\n  if (pendingUpdate) {\n    updateUserAvatarInDetail(pendingUpdate)\n    uni.removeStorageSync('userInfoPendingUpdate')\n  }\n})\n\nonUnmounted(() => {\n  uni.$off('userInfoUpdated')\n})\n\nonShow(() => {\n  const lastUpdate = uni.getStorageSync('lastUserInfoUpdate')\n  if (lastUpdate) {\n    updateUserAvatarInDetail(lastUpdate)\n  }\n  if (article.value) {\n    checkFavoriteStatus()\n  }\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.detailLayout {\n  min-height: 100vh;\n  background: #f8f9fa;\n}\n\n.soupDetail {\n  padding: 0;\n}\n\n.content {\n  background: #fff;\n  min-height: 100vh;\n  \n  /* 商家评价区域 - 新版设计 */\n  .shop-review-section {\n    padding: 24rpx;\n    background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);\n    \n    .shop-card {\n      background: #ffffff;\n      border-radius: 24rpx;\n      padding: 32rpx;\n      box-shadow: 0 4rpx 24rpx rgba(0, 0, 0, 0.06);\n      border: 1rpx solid #f1f5f9;\n      \n      /* 商家头部 */\n      .shop-header {\n        display: flex;\n        align-items: flex-start;\n        margin-bottom: 24rpx;\n        \n        .shop-avatar-container {\n          position: relative;\n          margin-right: 20rpx;\n          flex-shrink: 0;\n          \n          .shop-avatar {\n            width: 100rpx;\n            height: 100rpx;\n            border-radius: 20rpx;\n            border: 3rpx solid #ffffff;\n            box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.1);\n            background: #f8fafc;\n          }\n          \n          .shop-badge {\n            position: absolute;\n            bottom: -4rpx;\n            right: -4rpx;\n            width: 32rpx;\n            height: 32rpx;\n            background: linear-gradient(135deg, #4299e1, #3182ce);\n            border-radius: 50%;\n            border: 2rpx solid #ffffff;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            \n            .badge-icon {\n              color: #ffffff;\n              font-size: 18rpx;\n              font-weight: bold;\n            }\n          }\n        }\n        \n        .shop-main-info {\n          flex: 1;\n          min-width: 0;\n          \n          .shop-title-row {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 12rpx;\n            \n            .shop-name {\n              font-size: 32rpx;\n              font-weight: 700;\n              color: #1a202c;\n              line-height: 1.2;\n              overflow: hidden;\n              text-overflow: ellipsis;\n              white-space: nowrap;\n              max-width: 400rpx;\n            }\n            \n            .rating-display {\n              display: flex;\n              align-items: center;\n              background: linear-gradient(135deg, #FFF8E1, #FFECB3);\n              padding: 6rpx 12rpx;\n              border-radius: 16rpx;\n              border: 1rpx solid #FFD54F;\n              \n              .rating-star {\n                color: #FFD700;\n                font-size: 24rpx;\n                margin-right: 4rpx;\n              }\n              \n              .rating-value {\n                font-size: 26rpx;\n                color: #FF6B35;\n                font-weight: 700;\n              }\n            }\n          }\n          \n          .shop-tags {\n            display: flex;\n            align-items: center;\n            gap: 12rpx;\n            flex-wrap: wrap;\n            \n            .status-tag {\n              display: flex;\n              align-items: center;\n              padding: 6rpx 12rpx;\n              border-radius: 16rpx;\n              font-size: 22rpx;\n              \n              &.open {\n                background: #f0fff4;\n                color: #22543d;\n              }\n              \n              &:not(.open) {\n                background: #fed7d7;\n                color: #742a2a;\n              }\n              \n              .status-dot {\n                width: 12rpx;\n                height: 12rpx;\n                border-radius: 50%;\n                margin-right: 6rpx;\n                \n                &.open {\n                  background: #48bb78;\n                }\n                \n                &:not(.open) {\n                  background: #e53e3e;\n                }\n              }\n              \n              .status-text {\n                font-size: 22rpx;\n                font-weight: 500;\n              }\n            }\n            \n            .category-tag {\n              background: #ebf8ff;\n              color: #2b6cb0;\n              padding: 6rpx 12rpx;\n              border-radius: 16rpx;\n              font-size: 22rpx;\n            }\n          }\n        }\n      }\n      \n      /* 商家数据 */\n      .shop-stats {\n        display: flex;\n        align-items: center;\n        background: #f8fafc;\n        border-radius: 16rpx;\n        padding: 20rpx;\n        margin-bottom: 20rpx;\n        \n        .stat-item {\n          flex: 1;\n          text-align: center;\n          \n          .stat-value {\n            display: block;\n            font-size: 28rpx;\n            font-weight: 700;\n            color: #2d3748;\n            margin-bottom: 4rpx;\n          }\n          \n          .stat-label {\n            font-size: 22rpx;\n            color: #718096;\n          }\n        }\n        \n        .stat-divider {\n          width: 1rpx;\n          height: 32rpx;\n          background: #e2e8f0;\n        }\n      }\n      \n      /* 商家详情 */\n      .shop-details {\n        margin-bottom: 24rpx;\n        \n        .detail-item {\n          display: flex;\n          align-items: center;\n          padding: 12rpx 0;\n          border-bottom: 1rpx solid #f7fafc;\n          \n          &:last-child {\n            border-bottom: none;\n          }\n          \n          .detail-text {\n            flex: 1;\n            font-size: 26rpx;\n            color: #4a5568;\n            margin-left: 12rpx;\n          }\n          \n          .contact-btn {\n            background: #48bb78;\n            color: white;\n            padding: 8rpx 16rpx;\n            border-radius: 12rpx;\n            font-size: 22rpx;\n            font-weight: 500;\n          }\n        }\n      }\n      \n      /* 操作按钮 */\n      .shop-actions {\n        display: flex;\n        gap: 16rpx;\n        \n        .action-btn {\n          flex: 1;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          padding: 20rpx;\n          border-radius: 16rpx;\n          font-weight: 600;\n          font-size: 26rpx;\n          \n          &.primary {\n            background: linear-gradient(135deg, #FF6B35, #FF8E53);\n            color: white;\n          }\n          \n          &.secondary {\n            background: #ffffff;\n            color: #FF6B35;\n            border: 1rpx solid #FF6B35;\n          }\n          \n          .btn-text {\n            margin-left: 8rpx;\n          }\n        }\n      }\n    }\n  }\n\n  /* 用户信息区域 */\n  .userinfo {\n    display: flex;\n    align-items: center;\n    padding: 30rpx;\n    border-bottom: 1rpx solid #f0f0f0;\n\n    .user-avatar-container {\n      .avatar {\n        width: 80rpx;\n        height: 80rpx;\n        border-radius: 50%;\n        margin-right: 20rpx;\n        border: 2rpx solid #f0f0f0;\n      }\n    }\n\n    .user-info-main {\n      flex: 1;\n      \n      .username {\n        font-size: 32rpx;\n        font-weight: 600;\n        color: #333;\n        display: block;\n        margin-bottom: 8rpx;\n      }\n      \n      .time {\n        font-size: 24rpx;\n        color: #8b9ab6;\n      }\n    }\n  }\n\n  /* 评论内容样式 */\n  .comment-content {\n    padding: 30rpx;\n    border-bottom: 1rpx solid #f0f0f0;\n    \n    .comment-text {\n      font-size: 36rpx;\n      line-height: 1.8em;\n      color: #333;\n      word-break: break-word;\n    }\n  }\n\n  /* 图片区域 */\n  .pics {\n    display: grid;\n    grid-template-columns: repeat(3, 1fr);\n    gap: 16rpx;\n    padding: 30rpx;\n    border-bottom: 1rpx solid #f0f0f0;\n\n    .pic {\n      width: 100%;\n      height: 100%;\n      aspect-ratio: 1;\n      border-radius: 16rpx;\n      background-color: #f5f5f5;\n    }\n  }\n\n  /* 操作工具栏 */\n  .action-toolbar {\n    display: flex;\n    align-items: center;\n    justify-content: space-around;\n    padding: 30rpx;\n    \n    .toolbar-item {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      gap: 8rpx;\n      \n      .icon-wrapper {\n        width: 60rpx;\n        height: 60rpx;\n        border-radius: 50%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        background: #f8f9fa;\n        transition: all 0.3s ease;\n        \n        &.favorited {\n          background: #FF5B5B;\n        }\n        \n        &.delete {\n          background: #ffeaea;\n        }\n        \n        &:active {\n          transform: scale(0.95);\n        }\n      }\n      \n      .btn-text {\n        font-size: 24rpx;\n        color: #666;\n      }\n    }\n  }\n}\n\n.loading {\n  text-align: center;\n  padding: 100rpx 0;\n  color: #999;\n}\n\n/* 响应式调整 */\n@media (max-width: 375px) {\n  .shop-card {\n    padding: 24rpx !important;\n  }\n  \n  .shop-header {\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    \n    .shop-avatar-container {\n      margin-right: 0 !important;\n      margin-bottom: 16rpx;\n    }\n    \n    .shop-title-row {\n      flex-direction: column;\n      gap: 12rpx;\n    }\n  }\n  \n  .shop-actions {\n    flex-direction: column;\n  }\n}\n</style>","import MiniProgramPage from 'D:/uni-app/uniCloudDemo0717/pages/blog/detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","onLoad","uni","uniCloud","shopId","favoritesManager","onMounted","onUnmounted","onShow"],"mappings":"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"}