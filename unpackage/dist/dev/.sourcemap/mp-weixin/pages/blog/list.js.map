{"version":3,"file":"list.js","sources":["pages/blog/list.vue","E:/movie/HBuilderX.4.57.2025032507/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYmxvZy9saXN0LnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"blogList\">\n    <!-- 1 ÊØõÁéªÁíÉÂõ∫ÂÆöÂ§¥ÈÉ® -->\n    <view class=\"head\">\n      <home-head />\n    </view>\n\n    <!-- 2 ÂèØÊªöÂä®ÂÜÖÂÆπÂå∫ -->\n    <view class=\"body\">\n      <scroll-view\n        scroll-y\n        class=\"scrollBox\"\n        enable-back-to-top\n        @scrolltolower=\"loadMore\"\n        refresher-enabled\n        :refresher-triggered=\"refreshing\"\n        @refresherrefresh=\"onRefresh\"\n      >\n        <!-- ‰∏ãÊãâÂà∑Êñ∞ÊåáÁ§∫Âô® -->\n        <view v-if=\"refreshing\" class=\"refresh-indicator\">\n          <uni-load-more status=\"loading\" content=\"Âà∑Êñ∞‰∏≠...\"></uni-load-more>\n        </view>\n\n        <!-- È™®Êû∂Â±èÔºöÈ¶ñÊ¨°Âä†ËΩΩÂâçÂ±ïÁ§∫ -->\n        <view v-if=\"loading && articlesList.length === 0\" class=\"skeleton\">\n          <view v-for=\"i in 8\" :key=\"i\" class=\"card skeleton-card\" />\n        </view>\n\n        <!-- ÁúüÊ≠£ÁöÑÂàóË°® -->\n        <view v-else class=\"list\">\n          <view\n            class=\"card\"\n            v-for=\"item in articlesList\"\n            :key=\"item._id\"\n            @touchstart=\"touchStart\"\n            @touchend=\"touchEnd(item._id)\"\n          >\n            <view @click=\"goDetail(item._id)\">\n              <!-- Áî®Êà∑‰ø°ÊÅØ -->\n              <view class=\"userinfo\">\n                <image\n                  class=\"avatar\"\n                  :src=\"getUserAvatar(item.user_id[0])\"\n                  mode=\"aspectFill\"\n                  @error=\"handleAvatarError\"\n                  @load=\"onAvatarLoad(item.user_id[0])\"\n                />\n                <text class=\"username\">{{ item.user_id[0].nickname || 'ÂåøÂêç' }}</text>\n                <text class=\"time\">\n                  <uni-dateformat\n                    :date=\"item.publish_date\"\n                    format=\"MM-dd hh:mm\"\n                    :threshold=\"[60000,3600000*24*30]\"\n                  />\n                </text>\n              </view>\n              <!-- Ê≠£Êñá -->\n              <view class=\"content\">\n                <text class=\"text\">{{ item.content }}</text>\n              </view>\n            </view>\n            <!-- ÂõæÁâá -->\n            <view v-if=\"item.pics?.length\" class=\"pics\">\n              <image\n                v-for=\"(pic, idx) in item.pics\"\n                :key=\"idx\"\n                class=\"pic\"\n                :src=\"pic.url\"\n                mode=\"aspectFill\"\n                @click.stop=\"preview(item.pics, idx)\"\n              />\n            </view>\n\n            <!-- Â∫ïÈÉ®Â∑•ÂÖ∑Ê†è -->\n            <view class=\"toolbar\">\n              <view class=\"left\">\n                <text class=\"read\">{{ item.view_count || 0 }} ÊµèËßà</text>\n              </view>\n              <view class=\"right\">\n                <!-- Êî∂ËóèÊåâÈíÆ -->\n                <view class=\"favorite-btn\" @click.stop=\"toggleFavorite(item._id, item)\">\n                  <uni-icons \n                    :type=\"item.isFavorited ? 'heart-filled' : 'heart'\" \n                    :color=\"item.isFavorited ? '#FF5B5B' : '#8B9AB6'\" \n                    size=\"18\" \n                  />\n                </view>\n                \n                <!-- Âà†Èô§ÊåâÈíÆ -->\n                <view\n                  v-if=\"isPermission(item.user_id[0]._id)\"\n                  class=\"delete\"\n                  @click.stop=\"remove(item._id)\"\n                >\n                  <uni-icons type=\"trash\" size=\"18\" color=\"#fff\" />\n                </view>\n              </view>\n            </view>\n          </view>\n\n          <!-- Â∫ïÈÉ®Âä†ËΩΩÁä∂ÊÄÅ -->\n          <view class=\"footer\">\n            <view v-if=\"loadingMore\" class=\"loading-more\">\n              <uni-load-more status=\"loading\" content=\"Ê≠£Âú®Âä†ËΩΩ...\"></uni-load-more>\n            </view>\n            <view v-else-if=\"finished && articlesList.length > 0\" class=\"no-more\">\n              <text>--- ÊàëÊòØÊúâÂ∫ïÁ∫øÁöÑ ---</text>\n            </view>\n            <view v-else-if=\"articlesList.length === 0\" class=\"empty\">\n              <text class=\"empty-text\">ÊöÇÊó†ÂÜÖÂÆπÔºåÂø´ÂéªÂèëÂ∏ÉÁ¨¨‰∏ÄÊù°Âêß~</text>\n            </view>\n            <view v-else class=\"pull-up\">\n              <text>ÈáäÊîæÂä†ËΩΩÊõ¥Â§ö</text>\n            </view>\n          </view>\n        </view>\n      </scroll-view>\n    </view>\n\n    <!-- 3 Ê∏êÂèòÊÇ¨ÊµÆÂèëÂ∏ÉÊåâÈíÆ -->\n    <view class=\"fab\" @click=\"goAdd\">\n      <text class=\"icon\">+</text>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted, onUnmounted } from 'vue';\nimport { onShow, onHide, onPullDownRefresh, onReachBottom } from '@dcloudio/uni-app';\nimport { isPermission } from '@/utils/common.js';\nimport  favoritesManager  from '@/common/style/favorites.js';\n\nconst articlesCloudObj = uniCloud.importObject('articlesCloudObj');\n\nconst articlesList = ref([]);\nconst loading = ref(false);\nconst loadingMore = ref(false);\nconst refreshing = ref(false);\nconst finished = ref(false);\nlet page = 1;\nconst size = 8; // ÊØèÊ¨°Âä†ËΩΩ8Êù°Êï∞ÊçÆ\n\n// Áî®Êà∑Â§¥ÂÉèÁºìÂ≠ò\nconst userAvatarCache = ref(new Map());\nconst MAX_CACHE_SIZE = 30;\n\n/* È¶ñÊ¨°ÊãâÂèñ */\nonMounted(() => {\n  console.log('ÂçöÂÆ¢ÂàóË°®È°µÈù¢Âä†ËΩΩ');\n  setupUserInfoListeners();\n  getData(true);\n});\n\n/* È°µÈù¢Ëß¶Â∫ï‰∫ã‰ª∂ - Ê†∏ÂøÉ‰øÆÊîπ */\nonReachBottom(() => {\n  console.log('È°µÈù¢Ëß¶Â∫ïÔºåËß¶ÂèëÂä†ËΩΩÊõ¥Â§ö');\n  loadMore();\n});\n\n/* ‰∏ãÊãâÂà∑Êñ∞ */\nonPullDownRefresh(() => {\n  onRefresh();\n});\n\nconst goDetail = (e) => {\n  uni.navigateTo({\n    url: '/pages/blog/detail?id=' + e\n  });\n};\n\n/* ÁõëÂê¨ÁºñËæëÈ°µÂà∑Êñ∞ */\nuni.$on('editEvent', () => {\n  console.log('Êî∂Âà∞ÁºñËæë‰∫ã‰ª∂ÔºåÂà∑Êñ∞Êï∞ÊçÆ');\n  page = 1;\n  finished.value = false;\n  getData(true);\n});\n\n/* ÁõëÂê¨Áî®Êà∑‰ø°ÊÅØÊõ¥Êñ∞ */\nconst setupUserInfoListeners = () => {\n  uni.$on('userInfoUpdated', (data) => {\n    console.log('ÂçöÂÆ¢ÂàóË°®Êî∂Âà∞Áî®Êà∑‰ø°ÊÅØÊõ¥Êñ∞:', data);\n    updateUserAvatarInList(data);\n  });\n};\n\n// Êõ¥Êñ∞ÂàóË°®‰∏≠ÁöÑÁî®Êà∑Â§¥ÂÉè\nconst updateUserAvatarInList = (userData) => {\n  if (!userData.userId || !userData.avatar) return;\n  \n  console.log('ÂºÄÂßãÊõ¥Êñ∞ÂçöÂÆ¢ÂàóË°®‰∏≠ÁöÑÁî®Êà∑Â§¥ÂÉèÔºåÁî®Êà∑ID:', userData.userId);\n  \n  // Êõ¥Êñ∞ÁºìÂ≠ò\n  updateAvatarCache(userData.userId, userData.avatar);\n  \n  // Êõ¥Êñ∞ÂàóË°®‰∏≠ÁöÑÂ§¥ÂÉè\n  articlesList.value.forEach((item, index) => {\n    if (item.user_id && item.user_id[0] && item.user_id[0]._id === userData.userId) {\n      if (!item.user_id[0].avatar_file) {\n        item.user_id[0].avatar_file = {};\n      }\n      item.user_id[0].avatar_file.url = userData.avatar;\n      item.user_id[0].avatar_url = userData.avatar;\n      \n      // Âº∫Âà∂Ëß¶ÂèëËßÜÂõæÊõ¥Êñ∞\n      articlesList.value[index] = { ...articlesList.value[index] };\n    }\n  });\n};\n\n// ÊéßÂà∂ÁºìÂ≠òÂ§ßÂ∞è\nconst updateAvatarCache = (userId, avatarUrl) => {\n  if (userAvatarCache.value.size >= MAX_CACHE_SIZE) {\n    const firstKey = userAvatarCache.value.keys().next().value;\n    userAvatarCache.value.delete(firstKey);\n  }\n  userAvatarCache.value.set(userId, avatarUrl);\n};\n\n// Ëé∑ÂèñÁî®Êà∑Â§¥ÂÉè\nconst getUserAvatar = (user) => {\n  if (!user || !user._id) return '/static/defAvatar.png';\n  \n  const userId = user._id;\n  \n  // 1. ‰ºòÂÖàÊ£ÄÊü•ÁºìÂ≠ò\n  if (userAvatarCache.value.has(userId)) {\n    return userAvatarCache.value.get(userId);\n  }\n  \n  // 2. Ê£ÄÊü•Áî®Êà∑ÂØπË±°ÁöÑÂ§¥ÂÉèÊï∞ÊçÆ\n  let avatarUrl = '/static/defAvatar.png';\n  \n  if (user.avatar_url && user.avatar_url.startsWith('http')) {\n    avatarUrl = user.avatar_url;\n  } else if (user.avatar_file && user.avatar_file.url) {\n    const fileUrl = user.avatar_file.url;\n    if (fileUrl.startsWith('http')) {\n      avatarUrl = fileUrl;\n    } else if (fileUrl.startsWith('cloud:')) {\n      return '/static/defAvatar.png';\n    }\n  } else if (user.avatar && user.avatar.startsWith('http')) {\n    avatarUrl = user.avatar;\n  }\n  \n  if (avatarUrl !== '/static/defAvatar.png') {\n    updateAvatarCache(userId, avatarUrl);\n  }\n  \n  return avatarUrl;\n};\n\n// Â§¥ÂÉèÂä†ËΩΩÊàêÂäüÊó∂Â§ÑÁêÜ‰∫ëÂ≠òÂÇ®URL\nconst onAvatarLoad = (user) => {\n  if (!user || !user._id) return;\n  \n  const userId = user._id;\n  if (userAvatarCache.value.has(userId)) return;\n  \n  if (user.avatar_file && user.avatar_file.url && user.avatar_file.url.startsWith('cloud:')) {\n    convertCloudFileUrl(user.avatar_file.url, userId);\n  }\n};\n\n// ÂºÇÊ≠•ËΩ¨Êç¢‰∫ëÂ≠òÂÇ®URL\nconst convertCloudFileUrl = async (fileUrl, userId) => {\n  try {\n    const result = await uniCloud.getTempFileURL({\n      fileList: [fileUrl]\n    });\n    \n    if (result.fileList && result.fileList[0] && result.fileList[0].tempFileURL) {\n      const httpUrl = result.fileList[0].tempFileURL;\n      \n      // Êõ¥Êñ∞ÁºìÂ≠ò\n      updateAvatarCache(userId, httpUrl);\n      \n      // Êõ¥Êñ∞ÂàóË°®‰∏≠ÁöÑÂ§¥ÂÉè\n      updateAvatarInList(userId, httpUrl);\n    }\n  } catch (error) {\n    console.error('ËΩ¨Êç¢‰∫ëÂ≠òÂÇ®URLÂ§±Ë¥•:', error);\n  }\n};\n\n// Êõ¥Êñ∞ÂàóË°®‰∏≠ÁöÑÂ§¥ÂÉèURL\nconst updateAvatarInList = (userId, avatarUrl) => {\n  articlesList.value.forEach((item, index) => {\n    if (item.user_id && item.user_id[0] && item.user_id[0]._id === userId) {\n      if (!item.user_id[0].avatar_file) {\n        item.user_id[0].avatar_file = {};\n      }\n      item.user_id[0].avatar_file.url = avatarUrl;\n      item.user_id[0].avatar_url = avatarUrl;\n      \n      articlesList.value[index] = { ...articlesList.value[index] };\n    }\n  });\n};\n\n// Â§¥ÂÉèÂä†ËΩΩÂ§±Ë¥•Â§ÑÁêÜ\nconst handleAvatarError = (event) => {\n  console.log('Â§¥ÂÉèÂä†ËΩΩÂ§±Ë¥•:', event);\n};\n\n// Ëé∑ÂèñÊï∞ÊçÆ\nasync function getData(reset = true) {\n  if (reset) {\n    loading.value = true;\n    page = 1;\n  } else {\n    loadingMore.value = true;\n  }\n  \n  try {\n    console.log('Ëé∑ÂèñÂçöÂÆ¢ÂàóË°®Êï∞ÊçÆÔºåÈ°µÁ†Å:', page);\n    const { errCode, data } = await articlesCloudObj.list({ page, size });\n    \n    if (errCode === 0) {\n      console.log('Ëé∑ÂèñÂà∞Êï∞ÊçÆÊù°Êï∞:', data ? data.length : 0);\n      \n      if (reset) {\n        articlesList.value = data || [];\n      } else {\n        articlesList.value = [...articlesList.value, ...(data || [])];\n      }\n      \n      // Âà§Êñ≠ÊòØÂê¶Âä†ËΩΩÂÆåÊàê\n      finished.value = !data || data.length < size;\n      \n      console.log('Êï∞ÊçÆÂä†ËΩΩÂÆåÊàêÔºåÂàóË°®ÈïøÂ∫¶:', articlesList.value.length, 'ÊòØÂê¶ÂÆåÊàê:', finished.value);\n      \n      // Êï∞ÊçÆÂä†ËΩΩÂÆåÊàêÂêéÊ£ÄÊü•Êî∂ËóèÁä∂ÊÄÅ\n      if (articlesList.value.length > 0) {\n        await checkFavoritesStatus();\n      }\n      \n    } else {\n      console.error('Ëé∑ÂèñÊï∞ÊçÆÂ§±Ë¥•:', errCode);\n      uni.showToast({\n        title: 'Âä†ËΩΩÂ§±Ë¥•',\n        icon: 'none'\n      });\n    }\n  } catch (error) {\n    console.error('Ëé∑ÂèñÊï∞ÊçÆÂºÇÂ∏∏:', error);\n    uni.showToast({\n      title: 'ÁΩëÁªúÈîôËØØ',\n      icon: 'none'\n    });\n  } finally {\n    loading.value = false;\n    loadingMore.value = false;\n    refreshing.value = false;\n    uni.stopPullDownRefresh();\n  }\n}\n\n/* ========== Êî∂ËóèÁõ∏ÂÖ≥ÂäüËÉΩ ========== */\n\n// ÂàáÊç¢Êî∂ËóèÁä∂ÊÄÅ - Â¢ûÂº∫ÈîôËØØÂ§ÑÁêÜ\nasync function toggleFavorite(articleId, item) {\n  try {\n    // Ê£ÄÊü•Áî®Êà∑ÁôªÂΩïÁä∂ÊÄÅ\n    const userInfo = uni.getStorageSync('uni-id-pages-userInfo');\n    if (!userInfo || !userInfo._id) {\n      uni.showToast({ title: 'ËØ∑ÂÖàÁôªÂΩï', icon: 'none' });\n      return;\n    }\n    \n    console.log('ÂàáÊç¢Êî∂ËóèÁä∂ÊÄÅ:', { articleId, currentStatus: item.isFavorited });\n    \n    if (item.isFavorited) {\n      // ÂèñÊ∂àÊî∂Ëóè\n      const success = await favoritesManager.removeFavorite(articleId);\n      if (success) {\n        item.isFavorited = false;\n        uni.showToast({ title: 'ÂèñÊ∂àÊî∂Ëóè', icon: 'success' });\n      }\n    } else {\n      // Ê∑ªÂä†Êî∂Ëóè\n      const success = await favoritesManager.addFavorite(articleId);\n      if (success) {\n        item.isFavorited = true;\n        uni.showToast({ title: 'Êî∂ËóèÊàêÂäü', icon: 'success' });\n      }\n    }\n  } catch (error) {\n    console.error('ÂàáÊç¢Êî∂ËóèÁä∂ÊÄÅÂ§±Ë¥•:', error);\n    uni.showToast({ title: 'Êìç‰ΩúÂ§±Ë¥•ÔºåËØ∑ÈáçËØï', icon: 'none' });\n  }\n}\r\n\r\n\n// ÊâπÈáèÊ£ÄÊü•Êî∂ËóèÁä∂ÊÄÅ \nasync function checkFavoritesStatus() {\n    try {\n        const articleIds = articlesList.value.map(item => item._id).filter(id => id);\n        \n        if (articleIds.length === 0) {\n            console.log('Ê≤°ÊúâÊñáÁ´†ÈúÄË¶ÅÊ£ÄÊü•Êî∂ËóèÁä∂ÊÄÅ');\n            return;\n        }\n        \n        console.log('üîÑ ÂºÄÂßãÊ£ÄÊü•Êî∂ËóèÁä∂ÊÄÅÔºåÊñáÁ´†Êï∞Èáè:', articleIds.length);\n        \n        const favoritesStatus = await favoritesManager.batchCheckFavorites(articleIds);\n        console.log('‚úÖ Êî∂ËóèÁä∂ÊÄÅÊ£ÄÊü•ÂÆåÊàê:', favoritesStatus);\n        \n        // ÂÆâÂÖ®Âú∞Êõ¥Êñ∞ÂàóË°®È°πÁöÑÊî∂ËóèÁä∂ÊÄÅ\n        articlesList.value.forEach(item => {\n            if (item && item._id) {\n                item.isFavorited = favoritesStatus[item._id] || false;\n            }\n        });\n    } catch (error) {\n        console.error('Ê£ÄÊü•Êî∂ËóèÁä∂ÊÄÅÂ§±Ë¥•ÔºåËÆæÁΩÆÊâÄÊúâ‰∏∫Êú™Êî∂Ëóè:', error);\n        // Âá∫ÈîôÊó∂ËÆæÁΩÆÊâÄÊúâÊñáÁ´†‰∏∫Êú™Êî∂ËóèÁä∂ÊÄÅ\n        articlesList.value.forEach(item => {\n            if (item) {\n                item.isFavorited = false;\n            }\n        });\n    }\n}\r\n\n/* ‰∏ãÊãâÂà∑Êñ∞ */\nfunction onRefresh() {\n  if (refreshing.value) return;\n  \n  refreshing.value = true;\n  console.log('‰∏ãÊãâÂà∑Êñ∞');\n  getData(true);\n}\n\n/* Ëß¶Â∫ïÂä†ËΩΩÊõ¥Â§ö - Ê†∏ÂøÉ‰øÆÊîπ */\nfunction loadMore() {\n  // Èò≤Ê≠¢ÈáçÂ§çÂä†ËΩΩ\n  if (loadingMore.value || finished.value || loading.value) {\n    console.log('Ë∑≥ËøáÂä†ËΩΩ: loadingMore=', loadingMore.value, 'finished=', finished.value, 'loading=', loading.value);\n    return;\n  }\n  \n  console.log('Ëß¶Â∫ïÂä†ËΩΩÊõ¥Â§öÔºåÈ°µÁ†Å:', page + 1);\n  loadingMore.value = true;\n  page++;\n  getData(false);\n}\n\n/* Âà†Èô§ */\nasync function remove(id) {\n  const { confirm } = await uni.showModal({\n    title: 'ÊèêÁ§∫',\n    content: 'Á°ÆËÆ§Âà†Èô§ËøôÊù°ÈöèÁ¨îÔºü',\n    confirmColor: '#FF5B5B'\n  });\n  if (!confirm) return;\n  \n  const { errCode } = await articlesCloudObj.remove(id);\n  if (errCode === 0) {\n    uni.showToast({ title: 'Â∑≤Âà†Èô§', icon: 'none' });\n    page = 1;\n    getData(true);\n  }\n}\n\n/* ÂõæÁâáÈ¢ÑËßà */\nfunction preview(pics, idx) {\n  uni.previewImage({\n    urls: pics.map(p => p.url),\n    current: idx\n  });\n}\n\n/* ÊªëÂä®Âà†Èô§ - ÁÆÄÂçïÂÆûÁé∞ */\nlet startX = 0;\nfunction touchStart(e) {\n  startX = e.touches[0].pageX;\n}\nfunction touchEnd(id) {\n  const moveX = event.changedTouches[0].pageX - startX;\n  if (moveX < -80) remove(id);\n}\n\n/* ÂèëÂ∏É */\nfunction goAdd() {\n  uni.navigateTo({ url: '/pages/blog/edit' });\n}\n\n// È°µÈù¢Âç∏ËΩΩÊó∂ÁßªÈô§ÁõëÂê¨\nonUnmounted(() => {\n  console.log('ÂçöÂÆ¢ÂàóË°®È°µÈù¢Âç∏ËΩΩ');\n  uni.$off('userInfoUpdated');\n  uni.$off('editEvent');\n});\n\r\n// Âº∫Âà∂Âà∑Êñ∞ token\nasync function refreshToken() {\n  try {\n    const uniIdCo = uniCloud.importObject('uni-id-co');\n    const result = await uniIdCo.refreshToken();\n    console.log('Âà∑Êñ∞tokenÁªìÊûú:', result);\n  } catch (error) {\n    console.error('Âà∑Êñ∞tokenÂ§±Ë¥•:', error);\n  }\n};\n\r\n\r\n// Âú® list È°µÈù¢‰∏≠Ê∑ªÂä†Ë∞ÉËØïÊñπÊ≥ï\nasync function debugLoginStatus() {\n    try {\n        const articlesCloudObj = uniCloud.importObject('articlesCloudObj');\n        const result = await articlesCloudObj.debugLoginStatus();\n        console.log('üîç ÁôªÂΩïÁä∂ÊÄÅË∞ÉËØïÁªìÊûú:', result);\n    } catch (error) {\n        console.error('Ë∞ÉËØïÂ§±Ë¥•:', error);\n    }\n}\n\n// Âú® onShow Êàñ mounted ‰∏≠Ë∞ÉÁî®\nonMounted(() => {\n    debugLoginStatus();\n});\r\n\n\r\n\r\n\r\n</script>\n\n<style lang=\"scss\" scoped>\n/* Ê†∑Âºè‰øùÊåÅ‰∏çÂèòÔºåÊ∑ªÂä†Âà∑Êñ∞ÊåáÁ§∫Âô®Ê†∑Âºè */\n.refresh-indicator {\n  padding: 20rpx 0;\n  text-align: center;\n}\n\n.empty {\n  text-align: center;\n  padding: 100rpx 0;\n  \n  .empty-text {\n    font-size: 28rpx;\n    color: #999;\n  }\n}\n\n/* ÂÖ∂‰ªñÊ†∑Âºè‰øùÊåÅ‰∏çÂèò */\n/* -------------------- ÂèòÈáèÂå∫ -------------------- */\n$primary: #4F8BFF;\n$radius: 32rpx;\n$shadow: 0 8rpx 32rpx rgba(0, 0, 0, .08);\n$transition: all .3s cubic-bezier(.4, 0, .2, 1);\n\n/* -------------------- ‰∏ªÁªìÊûÑ -------------------- */\n.blogList {\n  min-height: 100vh;\n  background: linear-gradient(180deg, #CDE5FF 0%, #E9F3FF 100%);\n  display: flex;\n  flex-direction: column;\n}\n\n/* Â§¥ÈÉ®ÔºöÊØõÁéªÁíÉ */\n.head {\n  position: sticky;\n  top: 0;\n  z-index: 9;\n  backdrop-filter: blur(20rpx);\n  -webkit-backdrop-filter: blur(20rpx);\n  background: rgba(255, 255, 255, .65);\n  box-shadow: 0 2rpx 16rpx rgba(0, 0, 0, .05);\n}\n\n/* ÂÜÖÂÆπÂå∫ */\n.body {\n  flex: 1;\n  background-color: rgba(255, 255, 255, .65);\n  border-radius: $radius $radius 0 0;\n  overflow: hidden;\n  margin-top: -16rpx;\n}\n\n.scrollBox {\n  height: 100%;\n  padding: 24rpx 0rpx 40rpx;\n}\n\n/* -------------------- È™®Êû∂Â±è -------------------- */\n.skeleton {\n  .skeleton-card {\n    height: 280rpx;\n    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);\n    background-size: 200% 100%;\n    animation: loading 1.2s ease infinite;\n    margin-bottom: 24rpx;\n  }\n  @keyframes loading {\n    0% { background-position: 200% 0; }\n    100% { background-position: -200% 0; }\n  }\n}\n\n/* -------------------- Âç°Áâá -------------------- */\n.card {\n  background: #fff;\n  border-radius: $radius;\n  padding: 32rpx;\n  margin-bottom: 24rpx;\n  box-shadow: $shadow;\n  transition: $transition;\n  &:active { transform: scale(.98); }\n\n  .userinfo {\n    display: flex;\n    align-items: center;\n    margin-bottom: 20rpx;\n    .avatar {\n      width: 72rpx;\n      height: 72rpx;\n      border-radius: 50%;\n      border: 4rpx solid #fff;\n      box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, .1);\n      margin-right: 16rpx;\n    }\n    .username {\n      font-size: 30rpx;\n      font-weight: 600;\n      color: $primary;\n    }\n    .time {\n      margin-left: auto;\n      font-size: 24rpx;\n      color: #8B9AB6;\n    }\n  }\n\n  .content {\n    .text {\n      font-size: 34rpx;\n      line-height: 1.8em;\n      color: #222;\n      display: -webkit-box;\n      -webkit-line-clamp: 3;\n      -webkit-box-orient: vertical;\n      overflow: hidden;\n    }\n    .pics {\n      display: grid;\n      grid-template-columns: repeat(3, 1fr);\n      gap: 12rpx;\n      margin-top: 20rpx;\n    }\n  }\n  .pic {\n    width: 38%;\n    height: 38%;\n    border-radius: 12rpx;\n    aspect-ratio: 1;\n    overflow: hidden;\n  }\n\n  .toolbar {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-top: 24rpx;\n    \n    .left {\n      .read {\n        font-size: 24rpx;\n        color: #8B9AB6;\n      }\n    }\n    \n    .right {\n      display: flex;\n      align-items: center;\n      gap: 16rpx;\n      \n      .favorite-btn {\n        width: 56rpx;\n        height: 56rpx;\n        border-radius: 50%;\n        background: #f5f5f5;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: all 0.3s ease;\n        \n        &:active {\n          transform: scale(0.9);\n          background: #e0e0e0;\n        }\n      }\n      \n      .delete {\n        width: 56rpx;\n        height: 56rpx;\n        border-radius: 50%;\n        background: linear-gradient(135deg, #FF5B5B 0%, #FF8A8A 100%);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        box-shadow: 0 4rpx 12rpx rgba(255, 91, 91, 0.35);\n        transition: $transition;\n        &:active { transform: scale(.9); }\n      }\n    }\n  }\n}\n\n.footer {\n  text-align: center;\n  padding: 40rpx 0;\n  font-size: 24rpx;\n  color: #8B9AB6;\n  \n  .loading-more,\n  .no-more,\n  .pull-up {\n    padding: 20rpx 0;\n  }\n  \n  .no-more {\n    color: #999;\n  }\n  \n  .pull-up {\n    color: #4F8BFF;\n  }\n}\n\n/* -------------------- ÊÇ¨ÊµÆÂèëÂ∏ÉÊåâÈíÆ -------------------- */\n.fab {\n  position: fixed;\n  right: 40rpx;\n  bottom: 120rpx;\n  width: 112rpx;\n  height: 112rpx;\n  border-radius: 50%;\n  background: linear-gradient(135deg, #6AA6FF 0%, $primary 100%);\n  box-shadow: 0 8rpx 32rpx rgba($primary, .45);\n  display: grid;\n  place-items: center;\n  animation: fadeIn .6s ease both;\n  transition: $transition;\n  &:active { transform: scale(.9); }\n  .icon {\n    font-size: 56rpx;\n    color: #fff;\n    font-weight: 300;\n  }\n}\n\n@keyframes fadeIn {\n  from { opacity: 0; transform: translateY(40rpx) scale(.8); }\n  to { opacity: 1; transform: translateY(0) scale(1); }\n}\n</style>","import MiniProgramPage from 'D:/uni-app/uniCloudDemo0717/pages/blog/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["uniCloud","ref","onMounted","uni","onReachBottom","onPullDownRefresh","event","favoritesManager","onUnmounted","articlesCloudObj"],"mappings":"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"}