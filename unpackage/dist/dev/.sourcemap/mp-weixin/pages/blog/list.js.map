{"version":3,"file":"list.js","sources":["pages/blog/list.vue","E:/movie/HBuilderX.4.57.2025032507/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYmxvZy9saXN0LnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"layout\">\n\t\t<view class=\"list\">\n\t\t\t<view class=\"item\" v-for=\"(item,index) in articlesList\" :key=\"index\">\t\t\t\t\t\n\t\t\t\t<view class=\"userinfo\">\n\t\t\t\t\t<view class=\"avatar\"><image class=\"pic\" src=\"../../static/defAvatar.png\" mode=\"aspectFill\"></image></view>\n\t\t\t\t\t<view class=\"username\">{{item.user_id[0].nickname || \"匿名\"}}</view>\r\n                    \n\t\t\t\t</view>\n\t\t\t\t<view class=\"body\">\t\t\t\n\t\t\t\t\t<view class=\"text\">\n\t\t\t\t\t\t<view class=\"font\">{{item.content}}</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"piclist\" v-if=\"item.pics?.length\">\n\t\t\t\t\t\t<view class=\"pic\" v-for=\"(pic,index) in item.pics\" :key=\"index\">\n\t\t\t\t\t\t\t<image :src=\"pic.url\" mode=\"aspectFill\"></image>\n\t\t\t\t\t\t</view>\t\t\t\t\t\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t<view class=\"info\">\n\t\t\t\t\t<view class=\"left\">\t\t\t\t\n\t\t\t\t\t\t<uni-dateformat :date=\"item.publish_date\" format=\"MM月dd hh:mm\" :threshold=\"[60000,3600000*24*30]\"></uni-dateformat>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"right\">\t\t\t\t\n\t\t\t\t\t\t<view class=\"remove\" v-if=\"isPermission(item.user_id[0]._id)\" @click=\"remove(item._id)\">\n\t\t\t\t\t\t\t<uni-icons type=\"trash-filled\" size=\"16\" color=\"#999\"></uni-icons>删除\t\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t</view>\n\t\t</view>\n\t\t\t\t\n\t\t\n\t\t<uni-fab ref=\"fab\" :pattern=\"{icon:'compose'}\" horizontal=\"right\" vertical=\"bottom\" @fabClick=\"goAdd\"/>\n\t</view>\n</template>\n\n<script setup>\r\nimport { ref } from 'vue';\r\nimport {isPermission} from \"../../utils/common.js\"\r\n\r\nconst articlesCloudObj = uniCloud.importObject(\"articlesCloudObj\")\r\nconst articlesList = ref({});\r\n\r\nconst CurrentUserInfo = uniCloud.getCurrentUserInfo();\r\n\r\nconsole.log(CurrentUserInfo);\r\n\r\n//edit页面的事件接收\r\nuni.$on(\"editEvent\",(e)=>{\r\n    getData();\r\n    })\r\n\r\nconst remove = async(id)=>{\r\n try{\r\n     let feedback = await uni.showModal({\r\n         title:\"提示\",\r\n         content:\"是否确认删除？\"\r\n     })\r\n     if(!feedback.confirm)return;\r\n     let {errCode} = await articlesCloudObj.remove(id);\r\n     if (errCode ==0){\r\n         uni.showToast({\r\n             title:\"删除成功\",\r\n             icon:\"none\",\r\n            duration: 4000,          // 显式写出\r\n            complete: () => setTimeout(getData, 1000) // 等 toast 消失后再刷新\r\n         })\r\n     }\r\n }catch(err){\r\n     uni.showToast({\r\n         title:err,\r\n          icon:\"none\"\r\n     })\r\n }\r\n}\r\n\nconst getData= async()=>{\r\n    //解构\r\n \r\n    let {errCode,data} = await articlesCloudObj.list();\r\n    articlesList.value = data;\r\n    console.log(data);\r\n\r\n}\r\n\nconst goAdd = ()=>{\n\tuni.navigateTo({\n\t\turl:\"/pages/blog/edit\"\n\t})\n}\n\r\ngetData();\r\n\n</script>\n\n<style lang=\"scss\" scoped>\n.layout{\n\t.list{\n\t\t.item{\n\t\t\tpadding:40rpx 30rpx;\n\t\t\tborder-bottom:10px solid #f4f4f4;\n\t\t\t.userinfo{\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tborder-bottom:1px solid #f4f4f4;\n\t\t\t\tpadding-bottom:30rpx;\n\t\t\t\t.avatar{\n\t\t\t\t\twidth: 50rpx;\n\t\t\t\t\theight: 50rpx;\n\t\t\t\t\tborder-radius: 50%;\n\t\t\t\t\toverflow: hidden;\n\t\t\t\t\tmargin-right: 10rpx;\t\t\t\t\t\n\t\t\t\t\t.pic{\n\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t\theight: 100%;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t.username{\n\t\t\t\t\tfont-size: 28rpx;\n\t\t\t\t\tcolor:#333;\n\t\t\t\t}\n\t\t\t}\n\t\t\t.body{\n\t\t\t\tpadding:15rpx 0 30rpx;\t\t\n\t\t\t\t.text{\t\t\t\n\t\t\t\t\tpadding-bottom:10rpx;\n\t\t\t\t\tfont-size: 40rpx;\n\t\t\t\t\ttext-align: justify;\n\t\t\t\t\tcolor:#111;\n\t\t\t\t\tline-height: 1.7em;\n\t\t\t\t\t.font{\n\t\t\t\t\t\ttext-overflow: -o-ellipsis-lastline;\n\t\t\t\t\t\toverflow: hidden;\t\t\t\t\n\t\t\t\t\t\ttext-overflow: ellipsis;\t\t\n\t\t\t\t\t\tdisplay: -webkit-box;\t\t\t\n\t\t\t\t\t\t-webkit-line-clamp: 2;\t\t\t\n\t\t\t\t\t\tline-clamp: 2;\t\t\t\t\t\n\t\t\t\t\t\t-webkit-box-orient: vertical;\n\t\t\t\t\t\twidth: 100%;\t\t\t\t\n\t\t\t\t\t\tword-break:break-all; \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t.piclist{\n\t\t\t\t\tdisplay: grid;\n\t\t\t\t\tgrid-template-columns: repeat(3,1fr);\n\t\t\t\t\tgap: 15rpx;\n\t\t\t\t\tpadding-top:20rpx;\n\t\t\t\t\t.pic{\t\t\t\t\n\t\t\t\t\t\toverflow: hidden;\n\t\t\t\t\t\tborder-radius: 10rpx;\n\t\t\t\t\t\taspect-ratio: 1 / 1;\n\t\t\t\t\t\tborder-radius: 10rpx;\n\t\t\t\t\t\timage{\n\t\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t\t\theight: 100%;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t.info{\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tjustify-content:space-between;\n\t\t\t\tfont-size: 28rpx;\t\n\t\t\t\tcolor:#999;\t\t\n\t\t\t\t.right{\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\t.ipname{\n\t\t\t\t\t\tmargin-right: 20rpx;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\t\n\t\t}\n\t}\n}\n</style>\n","import MiniProgramPage from 'D:/uni-app/uniCloudDemo0717/pages/blog/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["uniCloud","ref","uni"],"mappings":";;;;;;;;;;;;;;;;;;;AA4CA,UAAM,mBAAmBA,cAAAA,GAAS,aAAa,kBAAkB;AACjE,UAAM,eAAeC,cAAAA,IAAI,CAAA,CAAE;AAE3B,UAAM,kBAAkBD,cAAAA,GAAS;AAEjCE,kBAAA,MAAA,MAAA,OAAA,6BAAY,eAAe;AAG3BA,kBAAAA,MAAI,IAAI,aAAY,CAAC,MAAI;AACrB;IACJ,CAAK;AAEL,UAAM,SAAS,OAAM,OAAK;AACzB,UAAG;AACC,YAAI,WAAW,MAAMA,cAAG,MAAC,UAAU;AAAA,UAC/B,OAAM;AAAA,UACN,SAAQ;AAAA,QACjB,CAAM;AACD,YAAG,CAAC,SAAS;AAAQ;AACrB,YAAI,EAAC,QAAO,IAAI,MAAM,iBAAiB,OAAO,EAAE;AAChD,YAAI,WAAU,GAAE;AACZA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAM;AAAA,YACN,MAAK;AAAA,YACN,UAAU;AAAA;AAAA,YACV,UAAU,MAAM,WAAW,SAAS,GAAI;AAAA;AAAA,UACpD,CAAU;AAAA,QACJ;AAAA,MACJ,SAAM,KAAI;AACPA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAM;AAAA,UACL,MAAK;AAAA,QACf,CAAM;AAAA,MACJ;AAAA,IACF;AAEA,UAAM,UAAS,YAAS;AAGpB,UAAI,EAAC,SAAQ,KAAI,IAAI,MAAM,iBAAiB,KAAI;AAChD,mBAAa,QAAQ;AACrBA,oBAAAA,MAAY,MAAA,OAAA,6BAAA,IAAI;AAAA,IAEpB;AAEA,UAAM,QAAQ,MAAI;AACjBA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAI;AAAA,MACN,CAAE;AAAA,IACF;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9FA,GAAG,WAAW,eAAe;"}