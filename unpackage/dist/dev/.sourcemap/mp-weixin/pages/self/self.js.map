{"version":3,"file":"self.js","sources":["pages/self/self.vue","E:/movie/HBuilderX.4.57.2025032507/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc2VsZi9zZWxmLnZ1ZQ"],"sourcesContent":["<template>\n    <view class=\"self\">\n        <!-- 顶部占位（适配状态栏） -->\n        <view :style=\"{ height: getNavBarHeight() + 'px' }\"></view>\n\n        <!-- 用户信息区 -->\n        <view class=\"userinfo\">\n            <view class=\"left\">\n                <view class=\"avatar-wrapper\">\n                    <image :src=\"userInfo.avatar\" mode=\"aspectFill\" class=\"avatar\"></image>\n                </view>\n                <view class=\"info\">\n                    <view class=\"username\">{{ userInfo.nickname }}</view>\n                    <view class=\"text\">喝汤的第 333 天</view>\n                </view>\n            </view>\n            <!-- 修复：移除 url 属性，只使用点击事件 -->\n            <view class=\"right\" @click=\"handleEditClick\">\n                <text class=\"edit-text\">编辑资料</text>\n                <uni-icons type=\"right\" size=\"20\" color=\"#999\"></uni-icons>\n            </view>\n        </view>\n\n        <!-- 功能卡片 -->\n        <view class=\"cardLayout\">\n            <view class=\"list\">\n                <!-- 修改：传递当前用户ID到item页面 -->\n                <view class=\"item\" hover-class=\"item-active\" @click=\"goToMyComments\">\n                    <view class=\"left\">\n                        <view class=\"icon\" style=\"background-image: linear-gradient(135deg, #6fcf97, #4bc0c8);\">\n                            <uni-icons custom-prefix=\"iconfont\" type=\"xxm-highlight-fill\" size=\"18\"\n                                color=\"#fff\"></uni-icons>\n                        </view>\n                        <view class=\"name\">我的锐评</view>\n                    </view>\n                    <view class=\"right\">\n                        <text class=\"count\">{{ myCommentsCount }}</text>\n                        <uni-icons type=\"right\" size=\"22\" color=\"#ccc\"></uni-icons>\n                    </view>\n                </view>\n\n                <navigator url=\"\" hover-class=\"item-active\">\n                    <view class=\"item\" hover-class=\"item-active\">\n                        <view class=\"left\">\n                            <view class=\"icon\" style=\"background-image: linear-gradient(135deg, #9c4dcc, #b388ff);\">\n                                <uni-icons custom-prefix=\"iconfont\" type=\"xxm-edit-fill\" size=\"18\" color=\"#fff\"></uni-icons>\n                            </view>\n                            <view class=\"name\">审核鸡汤</view>\n                        </view>\n                        <view class=\"right\">\n                            <text class=\"count\">33</text>\n                            <uni-icons type=\"right\" size=\"22\" color=\"#ccc\"></uni-icons>\n                        </view>\n                    </view>\n                </navigator>\n\n                <navigator url=\"/pages/self/favorites\" hover-class=\"item-active\">\n                    <view class=\"item\" hover-class=\"item-active\">\n                        <view class=\"left\">\n                            <view class=\"icon\" style=\"background-image: linear-gradient(135deg, #ffc857, #ff9a3c);\">\n                                <uni-icons custom-prefix=\"iconfont\" type=\"xxm-star-fill\" size=\"18\" color=\"#fff\"></uni-icons>\n                            </view>\n                            <view class=\"name\">我的收藏</view>\n                        </view>\n                        <view class=\"right\">\n                            <!-- 使用 favoritesCount 而不是 count -->\n                            <text class=\"count\">{{ favoritesCount }}</text>\n                            <uni-icons type=\"right\" size=\"22\" color=\"#ccc\"></uni-icons>\n                        </view>\n                    </view>\n                </navigator>\n                \n                <navigator url=\"\" hover-class=\"item-active\">\n                    <view class=\"item\" hover-class=\"item-active\">\n                        <view class=\"left\">\n                            <view class=\"icon\" style=\"background-image: linear-gradient(135deg, #ff7034, #ff4757);\">\n                                <uni-icons custom-prefix=\"iconfont\" type=\"xxm-message-fill\" size=\"18\"\n                                    color=\"#fff\"></uni-icons>\n                            </view>\n                            <view class=\"name\">联系我们</view>\n                        </view>\n                        <view class=\"right\">\n                            <text class=\"count\">在线客服</text>\n                            <uni-icons type=\"right\" size=\"22\" color=\"#ccc\"></uni-icons>\n                        </view>\n                    </view>\n                </navigator>\n            </view>\n        </view>\n\n        <!-- 设置区 -->\n        <view class=\"cardLayout\">\n            <view class=\"list\">\n                <view class=\"item\" hover-class=\"item-active\">\n                    <view class=\"left\">\n                        <view class=\"icon\" style=\"background-image: linear-gradient(135deg, #b5dfe8, #a2d2e2);\">\n                            <uni-icons custom-prefix=\"iconfont\" type=\"xxm-pushpin-fill\" size=\"18\"\n                                color=\"#fff\"></uni-icons>\n                        </view>\n                        <view class=\"name\">偏好设置</view>\n                    </view>\n                    <view class=\"right\">\n                        <text class=\"desc\">默认</text>\n                        <uni-icons type=\"right\" size=\"22\" color=\"#ccc\"></uni-icons>\n                    </view>\n                </view>\n\n                <view class=\"item\" hover-class=\"item-active\" @tap=\"handleLogout\">\n                    <view class=\"left\">\n                        <view class=\"icon\" style=\"background-image: linear-gradient(135deg, #b5dfe8, #a2d2e2);\">\n                            <uni-icons custom-prefix=\"iconfont\" type=\"xxm-api-fill\" size=\"18\" color=\"#fff\"></uni-icons>\n                        </view>\n                        <view class=\"name\">退出登录</view>\n                    </view>\n                    <view class=\"right\">\n                        <uni-icons type=\"right\" size=\"22\" color=\"#ccc\"></uni-icons>\n                    </view>\n                </view>\n            </view>\n        </view>\n    </view>\n</template>\n\n<script setup>\nimport { ref, onMounted, onUnmounted } from 'vue'\nimport { onShow, onPullDownRefresh, onLoad } from '@dcloudio/uni-app'\nimport { getNavBarHeight } from \"@/utils/system.js\";\nimport favoritesManager from '@/common/style/favorites.js'; // 导入收藏管理器\n\n// 用户信息\nconst userInfo = ref({\n    _id: '', // 添加 _id 字段\n    nickname: '咸虾米',\n    avatar: '/static/logo.png'\n})\n\n// 我的评论数量\nconst myCommentsCount = ref(0)\n\n// 跳转到我的评论页面\nconst goToMyComments = () => {\n    if (!userInfo.value._id) {\n        console.log('用户ID为空，无法跳转')\n        uni.showToast({\n            title: '请先登录',\n            icon: 'none'\n        })\n        return\n    }\n    \n    console.log('跳转到我的评论页面，用户ID:', userInfo.value._id)\n    \n    uni.navigateTo({\n        url: `/pages/self/item?userId=${userInfo.value._id}`,\n        success: () => {\n            console.log('跳转到我的评论页面成功')\n        },\n        fail: (error) => {\n            console.error('跳转失败:', error)\n            uni.showToast({\n                title: '跳转失败',\n                icon: 'none'\n            })\n        }\n    })\n}\n\n// 获取我的评论数量（用户文章数）\nconst getMyCommentsCount = async () => {\n  try {\n    if (!userInfo.value._id) {\n      console.log('用户ID为空，无法获取评论数量')\n      myCommentsCount.value = 0\n      return\n    }\n    \n    console.log('开始获取我的评论数量，用户ID:', userInfo.value._id)\n    \n    // 使用专门的方法获取用户文章数量\n    const articlesCloudObj = uniCloud.importObject('articlesCloudObj')\n    const res = await articlesCloudObj.getUserArticlesCount({\n      userId: userInfo.value._id\n    })\n    \n    if (res.errCode === 0) {\n      myCommentsCount.value = res.data || 0\n      console.log('我的评论数量:', myCommentsCount.value)\n    } else {\n      console.error('获取评论数量失败:', res.errMsg)\n      myCommentsCount.value = 0\n    }\n  } catch (error) {\n    console.error('获取评论数量失败:', error)\n    myCommentsCount.value = 0\n  }\n}\r\n\r\n\n// 监听编辑页面返回的数据\nconst setupEventListeners = () => {\n    // 监听全局事件（editSelf页面通过uni.$emit发送）\n    uni.$on('userInfoUpdated', (data) => {\n        console.log('通过全局事件接收到用户信息更新:', data)\n        updateUserInfo(data)\n    })\n}\n\n// 更新用户信息的方法\nconst updateUserInfo = (data) => {\n    console.log('开始更新用户信息:', data)\n    \n    // 检查用户ID是否匹配\n    if (data.userId === userInfo.value._id) {\n        // 更新头像\n        if (data.avatar && data.avatar !== userInfo.value.avatar) {\n            userInfo.value.avatar = data.avatar\n            console.log('头像已更新:', data.avatar)\n        }\n        // 更新昵称\n        if (data.nickname && data.nickname !== userInfo.value.nickname) {\n            userInfo.value.nickname = data.nickname\n            console.log('昵称已更新:', data.nickname)\n        }\n        \n        // 同时更新本地存储\n        const userInfoFromStorage = uni.getStorageSync('uni-id-pages-userInfo')\n        if (userInfoFromStorage) {\n            if (data.nickname) {\n                userInfoFromStorage.nickname = data.nickname\n            }\n            if (data.avatar) {\n                userInfoFromStorage.avatar = data.avatar\n            }\n            uni.setStorageSync('uni-id-pages-userInfo', userInfoFromStorage)\n            console.log('本地存储已更新')\n        }\n        \n        // 存储到临时位置，防止事件丢失（小程序特别需要）\n        uni.setStorageSync('userInfoPendingUpdate', data)\n        \n        // 显示更新成功的提示\n        uni.showToast({\n            title: '资料已更新',\n            icon: 'success',\n            duration: 1500\n        })\n    } else {\n        console.log('用户ID不匹配，不更新数据')\n    }\n}\n\n// 组件销毁时移除事件监听\nonUnmounted(() => {\n    uni.$off('userInfoUpdated')\n})\n\n// 收藏数量\nconst favoritesCount = ref(0)\n\n// 获取收藏数量\nasync function getFavoritesCount() {\n    try {\n        console.log('开始获取收藏数量...')\n        const favorites = await favoritesManager.getFavoritesList(1, 100); // 获取更多来计数\n        favoritesCount.value = favorites.length;\n        console.log('收藏数量:', favoritesCount.value);\n    } catch (error) {\n        console.error('获取收藏数量失败:', error);\n        favoritesCount.value = 0;\n    }\n}\n\n// 编辑资料点击处理\nconst handleEditClick = () => {\n    // 从本地存储获取当前用户ID\n    const userInfoFromStorage = uni.getStorageSync('uni-id-pages-userInfo');\n    console.log('本地存储的用户信息:', userInfoFromStorage);\n    \n    if (userInfoFromStorage && userInfoFromStorage._id) {\n        console.log('编辑用户:', userInfoFromStorage._id);\n        uni.navigateTo({\n            url: `/pages/self/editSelf?id=${userInfoFromStorage._id}`,\n            events: {\n                // 监听编辑页面发送的事件\n                userInfoUpdated: (data) => {\n                    console.log('通过事件通道接收到用户信息更新:', data)\n                    updateUserInfo(data)\n                }\n            },\n            success: (res) => {\n                // 可以通过事件通道向编辑页面发送数据\n                res.eventChannel.emit('acceptUserInfo', { \n                    userInfo: userInfo.value \n                })\n            }\n        });\n    } else {\n        console.error('未找到用户信息，本地存储内容:', uni.getStorageInfoSync());\n        uni.showToast({\n            title: '请先登录',\n            icon: 'none'\n        });\n    }\n}\n\n// 直接从本地存储获取用户信息，增加云函数强制同步\nasync function getUserInfo() {\n    try {\n        console.log('开始获取用户信息...')\n        \n        // 方法1：从 uni-id-pages 的存储中获取用户信息\n        const userInfoFromStorage = uni.getStorageSync('uni-id-pages-userInfo')\n        console.log('uni-id-pages 存储的用户信息:', userInfoFromStorage)\n        \n        if (userInfoFromStorage && userInfoFromStorage._id) {\n            // 强制从云函数获取最新数据（小程序环境特别需要）\n            try {\n                const articlesCloudObj = uniCloud.importObject('articlesCloudObj')\n                const cloudResult = await articlesCloudObj.getUserInfoById(userInfoFromStorage._id)\n                \n                if (cloudResult.errCode === 0 && cloudResult.data) {\n                    console.log('云函数返回的用户信息:', cloudResult.data)\n                    const cloudUserData = cloudResult.data\n                    \n                    let avatarUrl = '/static/logo.png'\n                    if (cloudUserData.avatar_url) {\n                        avatarUrl = cloudUserData.avatar_url\n                    } else if (cloudUserData.avatar_file && cloudUserData.avatar_file.url) {\n                        try {\n                            const result = await uniCloud.getTempFileURL({\n                                fileList: [cloudUserData.avatar_file.url]\n                            })\n                            if (result.fileList && result.fileList[0] && result.fileList[0].tempFileURL) {\n                                avatarUrl = result.fileList[0].tempFileURL\n                            }\n                        } catch (urlError) {\n                            console.error('URL转换失败:', urlError)\n                        }\n                    }\n                    \n                    // 使用云函数返回的数据\n                    userInfo.value = {\n                        _id: cloudUserData._id || userInfoFromStorage._id,\n                        nickname: cloudUserData.nickname || userInfoFromStorage.nickname || '咸虾米',\n                        avatar: avatarUrl\n                    }\n                    \n                    // 更新本地存储\n                    const updatedStorage = {\n                        ...userInfoFromStorage,\n                        nickname: cloudUserData.nickname || userInfoFromStorage.nickname,\n                        avatar: avatarUrl\n                    }\n                    uni.setStorageSync('uni-id-pages-userInfo', updatedStorage)\n                    \n                    console.log('从云函数同步用户信息成功:', userInfo.value)\n                    \n                    // 获取评论数量\n                    getMyCommentsCount()\n                    return\n                }\n            } catch (cloudError) {\n                console.warn('云函数获取失败，使用本地缓存:', cloudError)\n                // 云函数失败时使用本地存储\n            }\n            \n            // 云函数失败时的回退方案\n            const userData = userInfoFromStorage\n            let avatarUrl = '/static/logo.png'\n            \n            if (userData.avatar && userData.avatar !== '/static/logo.png') {\n                avatarUrl = userData.avatar\n            } else if (userData.avatar_file && userData.avatar_file.url) {\n                try {\n                    const result = await uniCloud.getTempFileURL({\n                        fileList: [userData.avatar_file.url]\n                    })\n                    if (result.fileList && result.fileList[0] && result.fileList[0].tempFileURL) {\n                        avatarUrl = result.fileList[0].tempFileURL\n                    }\n                } catch (urlError) {\n                    console.error('URL转换失败:', urlError)\n                }\n            }\n            \n            userInfo.value = {\n                _id: userData._id || '',\n                nickname: userData.nickname || '咸虾米',\n                avatar: avatarUrl\n            }\n            console.log('从本地存储获取用户信息成功:', userInfo.value)\n            \n            // 获取评论数量\n            getMyCommentsCount()\n            return\n        }\n        \n        // 方法2：如果本地存储没有，尝试从数据库查询\n        console.log('本地存储无用户信息，尝试数据库查询...')\n        const db = uniCloud.database()\n        const usersRes = await db.collection('uni-id-users')\n            .field('_id,nickname,avatar_file') // 添加 _id 字段\n            .limit(10)\n            .get()\n        \n        console.log('数据库查询结果:', usersRes)\n        \n        if (usersRes.data && usersRes.data.length > 0) {\n            // 使用第一个用户（开发环境）\n            const userData = usersRes.data[0]\n            let avatarUrl = '/static/logo.png'\n            \n            if (userData.avatar_file && userData.avatar_file.url) {\n                try {\n                    const result = await uniCloud.getTempFileURL({\n                        fileList: [userData.avatar_file.url]\n                    })\n                    if (result.fileList && result.fileList[0] && result.fileList[0].tempFileURL) {\n                        avatarUrl = result.fileList[0].tempFileURL\n                    }\n                } catch (urlError) {\n                    console.error('URL转换失败:', urlError)\n                }\n            }\n            \n            userInfo.value = {\n                _id: userData._id || '', // 获取用户ID\n                nickname: userData.nickname || '咸虾米',\n                avatar: avatarUrl\n            }\n            console.log('从数据库获取用户信息成功:', userInfo.value)\n            \n            // 获取评论数量\n            getMyCommentsCount()\n        } else {\n            // 保持默认值\n            userInfo.value = {\n                _id: '',\n                nickname: '咸虾米',\n                avatar: '/static/logo.png'\n            }\n            console.log('使用默认用户信息')\n        }\n        \n    } catch (error) {\n        console.error('获取用户信息失败:', error)\n        // 出错时使用默认值\n        userInfo.value = {\n            _id: '',\n            nickname: '咸虾米',\n            avatar: '/static/logo.png'\n        }\n    }\n    \n    // 停止下拉刷新\n    uni.stopPullDownRefresh()\n}\n\n// 手动刷新用户信息\nconst refreshUserInfo = () => {\n    uni.showLoading({\n        title: '刷新中...'\n    })\n    getUserInfo().finally(() => {\n        uni.hideLoading()\n        uni.showToast({\n            title: '刷新成功',\n            icon: 'success'\n        })\n    })\n}\n\n// 退出登录逻辑\nconst handleLogout = () => {\n    uni.showModal({\n        title: '确认退出',\n        content: '是否退出当前账号？',\n        success: function(res) {\n            if (res.confirm) {\n                // 清除所有用户相关存储\n                uni.removeStorageSync('uni_id_token')\n                uni.removeStorageSync('uni_id_token_expired')\n                uni.removeStorageSync('uni-id-pages-userInfo')\n                uni.removeStorageSync('uni_id_userinfo')\n                uni.removeStorageSync('userInfoPendingUpdate')\n                uni.reLaunch({\n                    url: '/uni_modules/uni-id-pages/pages/login/login-withoutpwd'\n                });\n            }\n        }\n    });\n};\n\n// 页面加载时获取用户信息\nonMounted(() => {\n    getUserInfo()\n})\n\n// 页面显示时重新获取用户信息\nonShow(() => {\n    console.log('页面显示，重新获取用户信息')\n    \n    // 方法1：直接调用云函数同步\n    getUserInfo()\n    \n    // 方法2：检查是否有待更新的数据（小程序特别需要）\n    const pendingUpdate = uni.getStorageSync('userInfoPendingUpdate')\n    if (pendingUpdate) {\n        console.log('发现待更新的用户信息:', pendingUpdate)\n        updateUserInfo(pendingUpdate)\n        uni.removeStorageSync('userInfoPendingUpdate')\n    }\n    \n    // 重新设置事件监听\n    setupEventListeners()\n    \n    // 添加收藏数量获取\n    getFavoritesCount()\n})\n\n// 下拉刷新\nonPullDownRefresh(() => {\n    console.log('下拉刷新，重新获取用户信息')\n    getUserInfo()\n})\n</script>\n\n<style lang=\"scss\" scoped>\n    $self-padding: 30rpx;\n    $card-radius: 20rpx;\n    $shadow: 0 10rpx 40rpx rgba(0, 0, 0, 0.08);\n\n    .self {\n        background: linear-gradient(135deg, #f8f9fa, #e9ecef);\n        min-height: 100vh;\n        padding-bottom: 30rpx;\n\n        // 用户信息区\n        .userinfo {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 50rpx $self-padding;\n            border-bottom: 1px solid #f0f0f0;\n\n            .left {\n                display: flex;\n                align-items: center;\n                padding-left: 10rpx;\n\n                .avatar-wrapper {\n                    position: relative;\n                    width: 120rpx;\n                    height: 120rpx;\n                    border-radius: 50%;\n                    overflow: hidden;\n                    box-shadow: 0 8rpx 20rpx rgba(111, 207, 151, 0.3);\n                    border: 4rpx solid #fff;\n                    transition: transform 0.3s ease;\n\n                    &:active {\n                        transform: scale(0.95);\n                    }\n\n                    .avatar {\n                        width: 100%;\n                        height: 100%;\n                        object-fit: cover;\n                    }\n                }\n\n                .info {\n                    margin-left: 24rpx;\n\n                    .username {\n                        font-size: 40rpx;\n                        font-weight: 700;\n                        color: #111;\n                        letter-spacing: -0.5px;\n                    }\n\n                    .text {\n                        font-size: 28rpx;\n                        color: #666;\n                        margin-top: 8rpx;\n                    }\n                }\n            }\n\n            .right {\n                display: flex;\n                align-items: center;\n                font-size: 28rpx;\n                color: #007aff;\n                font-weight: 500;\n                padding: 10rpx 20rpx;\n                border-radius: 20rpx;\n                transition: background-color 0.3s ease;\n\n                &:active {\n                    background-color: rgba(0, 122, 255, 0.1);\n                }\n\n                .edit-text {\n                    margin-right: 12rpx;\n                }\n            }\n        }\n\n        // 卡片样式\n        .cardLayout {\n            width: 690rpx;\n            margin: $self-padding auto;\n            border-radius: $card-radius;\n            overflow: hidden;\n\n            .list {\n                background: #fff;\n                border-radius: $card-radius;\n                box-shadow: $shadow;\n                overflow: hidden;\n\n                .item {\n                    display: flex;\n                    justify-content: space-between;\n                    align-items: center;\n                    padding: 34rpx 30rpx;\n                    border-bottom: 1px solid #f0f0f0;\n                    transition: background-color 0.2s ease;\n\n                    &:last-child {\n                        border-bottom: none;\n                    }\n\n                    .left {\n                        display: flex;\n                        align-items: center;\n\n                        .icon {\n                            width: 50rpx;\n                            height: 50rpx;\n                            border-radius: 50%;\n                            display: flex;\n                            align-items: center;\n                            justify-content: center;\n                            background-size: 200% 200%;\n                            animation: gradientShift 3s ease infinite;\n                        }\n\n                        .name {\n                            font-size: 30rpx;\n                            color: #333;\n                            margin-left: 20rpx;\n                            font-weight: 500;\n                        }\n                    }\n\n                    .right {\n                        display: flex;\n                        align-items: center;\n                        color: #999;\n\n                        .count,\n                        .desc {\n                            font-size: 26rpx;\n                            margin-right: 10rpx;\n                        }\n                    }\n                }\n\n                // 点击反馈\n                .item-active {\n                    background-color: #f5f5f5;\n                }\n            }\n        }\n    }\n\n    // 渐变动画（可选）\n    @keyframes gradientShift {\n        0% {\n            background-position: 0% 50%;\n        }\n\n        50% {\n            background-position: 100% 50%;\n        }\n\n        100% {\n            background-position: 0% 50%;\n        }\n    }\n</style>","import MiniProgramPage from 'D:/uni-app/uniCloudDemo0717/pages/self/self.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","uniCloud","onUnmounted","favoritesManager","avatarUrl","onMounted","onShow","onPullDownRefresh"],"mappings":"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"}